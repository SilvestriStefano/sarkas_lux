  

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>sarkas.simulation.params &mdash; Sarkas 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> Sarkas
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/tutorial.html">Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Source Code:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/modules.html">sarkas</a></li>
</ul>
<p class="caption"><span class="caption-text">Theoretical Background:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../theory/potentials.html">Potentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../theory/thermostats.html">Thermostats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../theory/PPPM.html">Particle-Particle Particle-Mesh Algorithm</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Sarkas</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>sarkas.simulation.params</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for sarkas.simulation.params</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module for handling Params class</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">yaml</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">scipy.constants</span> <span class="k">as</span> <span class="nn">const</span>

<span class="kn">from</span> <span class="nn">sarkas.time_evolution.integrators</span> <span class="kn">import</span> <span class="n">Integrator</span>
<span class="kn">from</span> <span class="nn">sarkas.time_evolution.thermostats</span> <span class="kn">import</span> <span class="n">Thermostat</span>


<div class="viewcode-block" id="Params"><a class="viewcode-back" href="../../../api/sarkas.simulation.params.html#sarkas.simulation.params.Params">[docs]</a><span class="k">class</span> <span class="nc">Params</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulation&#39;s Parameters.</span>
<span class="sd">    </span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    aws : float</span>
<span class="sd">        Wigner-Seitz radius. Calculated from the ``total_num_density`` .</span>

<span class="sd">    box_volume : float</span>
<span class="sd">        Box volume.</span>

<span class="sd">    dimensions : int</span>
<span class="sd">        Number of non-zero dimensions.</span>

<span class="sd">    fourpie0: float</span>
<span class="sd">        Electrostatic constant :math: `4\pi \espilon_0`.</span>

<span class="sd">    species : list</span>
<span class="sd">        List of Species objects with species&#39; information.</span>

<span class="sd">    load_method : str</span>
<span class="sd">        Particles loading described in Species.</span>

<span class="sd">    load_rand_seed : int</span>
<span class="sd">        Seed of random number generator.</span>

<span class="sd">    load_restart_step : int</span>
<span class="sd">        Restart time step.</span>

<span class="sd">    load_rejection_radius : float</span>
<span class="sd">        Rejection radius to avoid placing particles to close to each other.</span>

<span class="sd">    load_perturb : float</span>
<span class="sd">        Strength of initial perturbation.</span>

<span class="sd">    load_halton_bases : array, shape(3)</span>
<span class="sd">        Array of 3 ints each of which is a base for the Halton sequence.</span>

<span class="sd">    num_species : int</span>
<span class="sd">        Number of species.</span>

<span class="sd">    kB : float</span>
<span class="sd">        Boltzmann constant obtained from ``scipy.constants``.</span>

<span class="sd">    hbar : float</span>
<span class="sd">        Reduced Planck&#39;s constant.</span>

<span class="sd">    hbar2 : float</span>
<span class="sd">        Square of reduced Planck&#39;s constant.</span>

<span class="sd">    a0 : float</span>
<span class="sd">        Bohr Radius.</span>

<span class="sd">    c0 : float</span>
<span class="sd">        Speed of light.</span>

<span class="sd">    qe : float</span>
<span class="sd">        Elementary charge.</span>

<span class="sd">    me : float</span>
<span class="sd">        Electron mass.</span>

<span class="sd">    eps0 : float</span>
<span class="sd">        Vacuum electrical permittivity.</span>

<span class="sd">    eV2K : float</span>
<span class="sd">        Conversion factor from eV to Kelvin obtained from ``scipy.constants``.</span>

<span class="sd">    J2erg : float</span>
<span class="sd">        Conversion factor from Joules to erg. Needed for cgs units.</span>

<span class="sd">    QFactor : float</span>
<span class="sd">        Charge Factor defined as :math:`\mathcal Q = \sum_{i}^{N} q_{i}^2` .</span>

<span class="sd">    L : float</span>
<span class="sd">        Smallest box length.</span>

<span class="sd">    Lx : float</span>
<span class="sd">        Box length in the :math:`x` direction.</span>

<span class="sd">    Ly : float</span>
<span class="sd">        Box length in the :math:`y` direction.</span>

<span class="sd">    Lz : float</span>
<span class="sd">        Box length in the :math:`z` direction.</span>

<span class="sd">    Lv : array, shape(3)</span>
<span class="sd">        Box length in each direction.</span>

<span class="sd">    e1 : float</span>
<span class="sd">        Unit vector in the :math:`x` direction.</span>

<span class="sd">    e2 : float</span>
<span class="sd">        Unit vector in the :math:`y` direction.</span>

<span class="sd">    e3 : float</span>
<span class="sd">        Unit vector in the :math:`z` direction.</span>

<span class="sd">    N : int</span>
<span class="sd">        Total number of particles same as ``tot_num_ptcls``.</span>

<span class="sd">    ptcls_input_file : str</span>
<span class="sd">        User defined input file containing particles&#39; data.</span>

<span class="sd">    input_file : str</span>
<span class="sd">        YAML Input file with all the simulation&#39;s parameters.</span>

<span class="sd">    Te : float</span>
<span class="sd">        Equilibrium electron temperature. Defined in Potential module.</span>

<span class="sd">    Ti : float</span>
<span class="sd">        Total Equilibrium Ion temperature.</span>

<span class="sd">    T_desired : float</span>
<span class="sd">        Equilibrium temperature.</span>

<span class="sd">    tot_net_charge : float</span>
<span class="sd">        Total charge in the system.</span>

<span class="sd">    total_num_density : float</span>
<span class="sd">        Total number density. Calculated from the sum of ``Species.num_density``.</span>

<span class="sd">    total_num_ptcls : int</span>
<span class="sd">        Total number of particles. Calculated from the sum of ``Species.num``.</span>

<span class="sd">    wp : float</span>
<span class="sd">        Total Plasma frequency. Defined in Potential module.</span>

<span class="sd">    force : func</span>
<span class="sd">        Function for force calculation. Assigned in Potential module.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Container of Species</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ne</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Lv</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_file</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">box_volume</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">J2erg</span> <span class="o">=</span> <span class="mf">1.0e+7</span>  <span class="c1"># erg/J</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eps0</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">epsilon_0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fourpie0</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">me</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">physical_constants</span><span class="p">[</span><span class="s2">&quot;electron mass&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qe</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">physical_constants</span><span class="p">[</span><span class="s2">&quot;elementary charge&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hbar</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">hbar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hbar2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hbar</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c0</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">physical_constants</span><span class="p">[</span><span class="s2">&quot;speed of light in vacuum&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eV2K</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">physical_constants</span><span class="p">[</span><span class="s2">&quot;electron volt-kelvin relationship&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eV2J</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">physical_constants</span><span class="p">[</span><span class="s2">&quot;electron volt-joule relationship&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a0</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">physical_constants</span><span class="p">[</span><span class="s2">&quot;Bohr radius&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kB</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">Boltzmann</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aws</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tot_net_charge</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">QFactor</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_species</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_ion_temperature</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T_desired</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_num_density</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_num_ptcls</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P3M</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Magnetic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Magnetic</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">potential</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Potential</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">integrator</span> <span class="o">=</span> <span class="n">Integrator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Control</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thermostat</span> <span class="o">=</span> <span class="n">Thermostat</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Langevin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Langevin</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostProcessing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PostProcessing</span><span class="p">()</span>

<div class="viewcode-block" id="Params.BC"><a class="viewcode-back" href="../../../api/sarkas.simulation.params.html#sarkas.simulation.params.Params.BC">[docs]</a>    <span class="k">class</span> <span class="nc">BC</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Boundary Conditions.</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        pbc_axes : list</span>
<span class="sd">            Axes with Periodic Boundary Conditions.</span>

<span class="sd">        mm_axes : list</span>
<span class="sd">            Axes with Momentum Mirror Conditions.</span>

<span class="sd">        open_axes: list</span>
<span class="sd">            Axes with Open Boundary Conditions.</span>

<span class="sd">        pbc_axes_indx : array</span>
<span class="sd">            Indexes of axes with Periodic Boundary Conditions.</span>

<span class="sd">        mm_axes_indx : array</span>
<span class="sd">            Indexes of axes with Momentum Mirror Conditions.</span>

<span class="sd">        open_axes_indx: array</span>
<span class="sd">            Indexes of axes with Open Boundary Conditions.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pbc_axes</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mm_axes</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">open_axes</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pbc_axes_indx</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mm_axes_indx</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">open_axes_indx</span> <span class="o">=</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="Params.Species"><a class="viewcode-back" href="../../../api/sarkas.simulation.params.html#sarkas.simulation.params.Params.Species">[docs]</a>    <span class="k">class</span> <span class="nc">Species</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Particle Species.</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">            name : str</span>
<span class="sd">                Species&#39; name.</span>

<span class="sd">            number_density : float</span>
<span class="sd">                Species number density in appropriate units.</span>

<span class="sd">            num : int</span>
<span class="sd">                Number of particles of Species.</span>

<span class="sd">            mass : float</span>
<span class="sd">                Species&#39; mass.</span>

<span class="sd">            charge : float</span>
<span class="sd">                Species&#39; charge.</span>

<span class="sd">            Z : float</span>
<span class="sd">                Species charge number.</span>
<span class="sd">            </span>
<span class="sd">            atomic_weight : float</span>
<span class="sd">                Species atomic weight.</span>

<span class="sd">            init_vel: array</span>
<span class="sd">                Initial velocity in x,y,z directions.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">number_density</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_method</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">pass</span></div>

<div class="viewcode-block" id="Params.Magnetic"><a class="viewcode-back" href="../../../api/sarkas.simulation.params.html#sarkas.simulation.params.Params.Magnetic">[docs]</a>    <span class="k">class</span> <span class="nc">Magnetic</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Parameters for a plasma in a constant magnetic field</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        on : bool</span>
<span class="sd">            Flag for magnetized plasma.</span>

<span class="sd">        elec_therm : int</span>
<span class="sd">            Thermalize electrostatic forces first?</span>
<span class="sd">            0 = False, 1 = True (default).</span>

<span class="sd">        Neq_mag : int</span>
<span class="sd">            Number of equilibration steps with magnetic field on.</span>

<span class="sd">        Bfield : float</span>
<span class="sd">            Strength of Magnetic Field.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elec_therm</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Neq_mag</span> <span class="o">=</span> <span class="mi">10000</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BField</span> <span class="o">=</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="Params.Potential"><a class="viewcode-back" href="../../../api/sarkas.simulation.params.html#sarkas.simulation.params.Params.Potential">[docs]</a>    <span class="k">class</span> <span class="nc">Potential</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters specific to potential choice.</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        matrix : array</span>
<span class="sd">            Potential&#39;s parameters.</span>

<span class="sd">        method : str</span>
<span class="sd">            Algorithm to use for force calculations.</span>
<span class="sd">            &quot;PP&quot; = Linked Cell List (default).</span>
<span class="sd">            &quot;P3M&quot; = Particle-Particle Particle-Mesh.</span>

<span class="sd">        rc : float</span>
<span class="sd">            Cutoff radius.</span>

<span class="sd">        type : str</span>
<span class="sd">            Interaction potential: LJ, Yukawa, EGS, Coulomb, QSP, Moliere.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;PP&quot;</span></div>

<div class="viewcode-block" id="Params.P3M"><a class="viewcode-back" href="../../../api/sarkas.simulation.params.html#sarkas.simulation.params.Params.P3M">[docs]</a>    <span class="k">class</span> <span class="nc">P3M</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        P3M Algorithm parameters.</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        aliases : array, shape(3)</span>
<span class="sd">            Number of aliases in each direction.</span>

<span class="sd">        cao : int</span>
<span class="sd">            Charge assignment order.</span>

<span class="sd">        on : bool</span>
<span class="sd">            Flag.</span>

<span class="sd">        MGrid : array, shape(3), int</span>
<span class="sd">            Number of mesh point in each direction.</span>

<span class="sd">        Mx : int</span>
<span class="sd">            Number of mesh point along the :math:`x` axis.</span>

<span class="sd">        My : int</span>
<span class="sd">            Number of mesh point along the :math:`y` axis.</span>

<span class="sd">        Mz : int</span>
<span class="sd">            Number of mesh point along the :math:`z` axis.</span>

<span class="sd">        mx_max : int</span>
<span class="sd">            Number of aliases along the reciprocal :math:`x` direction.</span>

<span class="sd">        my_max : int</span>
<span class="sd">            Number of aliases along the reciprocal :math:`y` direction.</span>

<span class="sd">        mz_max : int</span>
<span class="sd">            Number of aliases along the reciprocal :math:`z` direction.</span>

<span class="sd">        G_ew : float</span>
<span class="sd">            Ewald parameter.</span>

<span class="sd">        G_k : array</span>
<span class="sd">            Optimized Green&#39;s function.</span>

<span class="sd">        hx : float</span>
<span class="sd">            Mesh spacing in :math:`x` direction.</span>

<span class="sd">        hy : float</span>
<span class="sd">            Mesh spacing in :math:`y` direction.</span>

<span class="sd">        hz : float</span>
<span class="sd">            Mesh spacing in :math:`z` direction.</span>

<span class="sd">        PP_err : float</span>
<span class="sd">            Force error due to short range cutoff.</span>

<span class="sd">        PM_err : float</span>
<span class="sd">            Force error due to long range cutoff.</span>

<span class="sd">        F_err : float</span>
<span class="sd">            Total force error.</span>

<span class="sd">        kx_v : array</span>
<span class="sd">            Array of :math:`k_x` values.</span>

<span class="sd">        ky_v : array</span>
<span class="sd">            Array of :math:`k_y` values.</span>

<span class="sd">        kz_v : array</span>
<span class="sd">            Array of :math:`k_z` values.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Params.Langevin"><a class="viewcode-back" href="../../../api/sarkas.simulation.params.html#sarkas.simulation.params.Params.Langevin">[docs]</a>    <span class="k">class</span> <span class="nc">Langevin</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters for Langevin Dynamics.</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">            on : int</span>
<span class="sd">                Flag. 0 = False, 1 = True.</span>

<span class="sd">            type : str</span>
<span class="sd">                Type of Langevin. </span>

<span class="sd">            gamma : float</span>
<span class="sd">                Langeving gamma.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on</span> <span class="o">=</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="Params.Control"><a class="viewcode-back" href="../../../api/sarkas.simulation.params.html#sarkas.simulation.params.Params.Control">[docs]</a>    <span class="k">class</span> <span class="nc">Control</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        General simulation parameters</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">            units : str</span>
<span class="sd">                cgs or mks.</span>

<span class="sd">            dt : float</span>
<span class="sd">                timestep. Same as ``Params.dt``.</span>

<span class="sd">            Nsteps : int</span>
<span class="sd">                Number of simulation timesteps.</span>

<span class="sd">            BC : str</span>
<span class="sd">                Boundary Condition. &#39;Periodic&#39; only.</span>

<span class="sd">            dump_step : int</span>
<span class="sd">                Production Snapshot interval.</span>

<span class="sd">            therm_dump_step : int</span>
<span class="sd">                Thermalization Snapshot interval.</span>

<span class="sd">            np_per_side : array</span>
<span class="sd">                Number of particles per box length. Default= :math: `N_{tot}^{1/3}`</span>
<span class="sd">                Note that :math: `N_x x N_y x N_z = N_{tot}`</span>

<span class="sd">            writexyz : str</span>
<span class="sd">                Flag for XYZ file for OVITO. Default = False.</span>

<span class="sd">            verbose : str</span>
<span class="sd">                Flag for verbose screen output.</span>
<span class="sd">            </span>
<span class="sd">            checkpoint_dir : str</span>
<span class="sd">                Path to the directory where the outputs of the current simulation will be stored.</span>
<span class="sd">                Default = &quot;Simulations/UnNamedRun&quot;</span>

<span class="sd">            log_file : str</span>
<span class="sd">                File name for log output. Default = log.out</span>

<span class="sd">            pre_run : bool</span>
<span class="sd">                Flag for initial estimation of simulation parameters.</span>

<span class="sd">            simulations_dir : str</span>
<span class="sd">                Path to the directory where all future simulations will be stored. Default = cwd +  &quot;Simulations&quot;</span>

<span class="sd">            dump_dir : str</span>
<span class="sd">                Path to the directory where simulations&#39; dumps will be stored.</span>
<span class="sd">                Default = &quot;Simulations/UnNamedRun/Production&quot;</span>

<span class="sd">            therm_dir : str</span>
<span class="sd">                Path to the directory where simulations&#39; dumps will be stored.</span>
<span class="sd">                Default = &quot;Simulations/UnNamedRun/Thermalization&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">measure</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">writexyz</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">simulations_dir</span> <span class="o">=</span> <span class="s2">&quot;Simulations&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">job_dir</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">production_dir</span> <span class="o">=</span> <span class="s1">&#39;Production&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">equilibration_dir</span> <span class="o">=</span> <span class="s1">&#39;Equilibration&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing_dir</span> <span class="o">=</span> <span class="s2">&quot;PreProcessing&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">postprocessing_dir</span> <span class="o">=</span> <span class="s2">&quot;PostProcessing&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">job_id</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log_file</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">np_per_side</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pre_run</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Params.PostProcessing"><a class="viewcode-back" href="../../../api/sarkas.simulation.params.html#sarkas.simulation.params.Params.PostProcessing">[docs]</a>    <span class="k">class</span> <span class="nc">PostProcessing</span><span class="p">:</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rdf_nbins</span> <span class="o">=</span> <span class="mi">100</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ssf_no_ka_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dsf_no_ka_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hermite_order</span> <span class="o">=</span> <span class="mi">10</span></div>

<div class="viewcode-block" id="Params.setup"><a class="viewcode-back" href="../../../api/sarkas.simulation.params.html#sarkas.simulation.params.Params.setup">[docs]</a>    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setup simulations&#39; parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        args : dict</span>
<span class="sd">            Input arguments</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_parameters</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_directories</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>


        <span class="k">return</span></div>

<div class="viewcode-block" id="Params.common_parser"><a class="viewcode-back" href="../../../api/sarkas.simulation.params.html#sarkas.simulation.params.Params.common_parser">[docs]</a>    <span class="k">def</span> <span class="nf">common_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse common parameters from input file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str</span>
<span class="sd">            Input file&#39;s name.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_file</span> <span class="o">=</span> <span class="n">filename</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">stream</span><span class="p">:</span>
            <span class="n">dics</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lkey</span> <span class="ow">in</span> <span class="n">dics</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">lkey</span> <span class="o">==</span> <span class="s2">&quot;Particles&quot;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">species</span> <span class="ow">in</span> <span class="n">dics</span><span class="p">[</span><span class="s2">&quot;Particles&quot;</span><span class="p">]:</span>
                        <span class="n">spec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Species</span><span class="p">()</span>
                        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">species</span><span class="p">[</span><span class="s2">&quot;Species&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                                <span class="n">spec</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="nb">setattr</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">lkey</span> <span class="o">==</span> <span class="s2">&quot;Potential&quot;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dics</span><span class="p">[</span><span class="n">lkey</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">potential</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">potential</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">potential</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">lkey</span> <span class="o">==</span> <span class="s2">&quot;P3M&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">on</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">dics</span><span class="p">[</span><span class="n">lkey</span><span class="p">]:</span>
                        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;MGrid&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">MGrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">Mx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">MGrid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">My</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">MGrid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">Mz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">MGrid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;cao&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">cao</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;aliases&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">aliases</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">mx_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">aliases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">my_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">aliases</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">mz_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">aliases</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;alpha_ewald&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">pppm</span><span class="o">.</span><span class="n">G_ew</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">lkey</span> <span class="o">==</span> <span class="s2">&quot;Thermostat&quot;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dics</span><span class="p">[</span><span class="n">lkey</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thermostat</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">thermostat</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thermostat</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">lkey</span> <span class="o">==</span> <span class="s2">&quot;Magnetized&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Magnetic</span><span class="o">.</span><span class="n">on</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">dics</span><span class="p">[</span><span class="n">lkey</span><span class="p">]:</span>
                        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;B_Gauss&quot;</span><span class="p">:</span>
                                <span class="n">G2T</span> <span class="o">=</span> <span class="mf">1e-4</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">Magnetic</span><span class="o">.</span><span class="n">BField</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">*</span> <span class="n">G2T</span>

                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;B_Tesla&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">Magnetic</span><span class="o">.</span><span class="n">BField</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;electrostatic_thermalization&quot;</span><span class="p">:</span>
                                <span class="c1"># 1 = true, 0 = false</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">Magnetic</span><span class="o">.</span><span class="n">elec_therm</span> <span class="o">=</span> <span class="n">value</span>

                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Neq_mag&quot;</span><span class="p">:</span>
                                <span class="c1"># Number of equilibration of magnetic degrees of freedom</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">Magnetic</span><span class="o">.</span><span class="n">Neq_mag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">lkey</span> <span class="o">==</span> <span class="s2">&quot;Integrator&quot;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dics</span><span class="p">[</span><span class="n">lkey</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">integrator</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">integrator</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">integrator</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">lkey</span> <span class="o">==</span> <span class="s2">&quot;Langevin&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Langevin</span><span class="o">.</span><span class="n">on</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">dics</span><span class="p">[</span><span class="n">lkey</span><span class="p">]:</span>
                        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">Langevin</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">value</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">Langevin</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">lkey</span> <span class="o">==</span> <span class="s2">&quot;PostProcessing&quot;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">dics</span><span class="p">[</span><span class="n">lkey</span><span class="p">]:</span>
                        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">keyword</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;rdf_nbins&#39;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">PostProcessing</span><span class="o">.</span><span class="n">rdf_nbins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;ssf_no_ka_values&#39;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">PostProcessing</span><span class="o">.</span><span class="n">ssf_no_ka_values</span> <span class="o">=</span> <span class="n">value</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;dsf_no_ka_values&#39;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">PostProcessing</span><span class="o">.</span><span class="n">dsf_no_ka_values</span> <span class="o">=</span> <span class="n">value</span>

                <span class="k">if</span> <span class="n">lkey</span> <span class="o">==</span> <span class="s2">&quot;BoundaryConditions&quot;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dics</span><span class="p">[</span><span class="n">lkey</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;periodic&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">pbc_axes</span> <span class="o">=</span> <span class="n">value</span>

                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;momentum_mirror&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">mm_axes</span> <span class="o">=</span> <span class="n">value</span>

                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;open&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">open_axes</span> <span class="o">=</span> <span class="n">value</span>

                <span class="k">if</span> <span class="n">lkey</span> <span class="o">==</span> <span class="s2">&quot;Control&quot;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dics</span><span class="p">[</span><span class="n">lkey</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="c1"># Check for conflicts in case of magnetic field</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Magnetic</span><span class="o">.</span><span class="n">on</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">Magnetic</span><span class="o">.</span><span class="n">elec_therm</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">integrator</span><span class="o">.</span><span class="n">mag_type</span> <span class="o">=</span> <span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">integrator</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;Verlet&#39;</span>

        <span class="c1"># Check for thermostat temperatures</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thermostat</span><span class="p">,</span> <span class="s1">&#39;temperatures&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thermostat</span><span class="o">.</span><span class="n">temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">thermostat</span><span class="o">.</span><span class="n">temperatures</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">temperature</span></div>

<div class="viewcode-block" id="Params.create_directories"><a class="viewcode-back" href="../../../api/sarkas.simulation.params.html#sarkas.simulation.params.Params.create_directories">[docs]</a>    <span class="k">def</span> <span class="nf">create_directories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check for undefined control variables and create output directory and its subdirectories.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ---------</span>
<span class="sd">        args: dict</span>
<span class="sd">            Input arguments.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check for directories</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="c1"># Check if the directories exist</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulations_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulations_dir</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">job_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulations_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_dir</span><span class="p">)</span>

        <span class="c1"># Equilibration directory and sub_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">equilibration_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">equilibration_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">equilibration_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">equilibration_dir</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eq_dump_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">equilibration_dir</span><span class="p">,</span> <span class="s1">&#39;dumps&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eq_dump_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eq_dump_dir</span><span class="p">)</span>

        <span class="c1"># Production dir and sub_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">production_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">production_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">production_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">production_dir</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prod_dump_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">production_dir</span><span class="p">,</span> <span class="s2">&quot;dumps&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prod_dump_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prod_dump_dir</span><span class="p">)</span>

        <span class="c1"># Postprocessing dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postprocessing_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">postprocessing_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postprocessing_dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">postprocessing_dir</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_dir</span><span class="p">,</span> <span class="s1">&#39;log.out&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Params.assign_attributes"><a class="viewcode-back" href="../../../api/sarkas.simulation.params.html#sarkas.simulation.params.Params.assign_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">assign_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Assign the parsed parameters&quot;&quot;&quot;</span>
        <span class="c1"># Physical constants</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;cgs&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kB</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">J2erg</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c0</span> <span class="o">*=</span> <span class="mf">1e2</span>  <span class="c1"># cm/s</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">potential</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;LJ&quot;</span><span class="p">):</span>
                <span class="c1"># Coulomb to statCoulomb conversion factor. See https://en.wikipedia.org/wiki/Statcoulomb</span>
                <span class="n">C2statC</span> <span class="o">=</span> <span class="mf">1.0e-01</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">c0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">J2erg</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">hbar</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hbar2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hbar</span> <span class="o">**</span> <span class="mi">2</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">qe</span> <span class="o">*=</span> <span class="n">C2statC</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">me</span> <span class="o">*=</span> <span class="mf">1.0e3</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">eps0</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fourpie0</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a0</span> <span class="o">*=</span> <span class="mf">1e2</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">job_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_species</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">)</span>
        <span class="c1"># Loop over species and assign missing attributes</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_num_ptcls</span> <span class="o">+=</span> <span class="n">sp</span><span class="o">.</span><span class="n">num</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s2">&quot;number_density&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">total_num_density</span> <span class="o">+=</span> <span class="n">sp</span><span class="o">.</span><span class="n">number_density</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s2">&quot;atomic_weight&quot;</span><span class="p">):</span>
                <span class="c1"># Choose between atomic mass constant or proton mass</span>
                <span class="c1"># u = const.physical_constants[&quot;atomic mass constant&quot;][0]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mp</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">physical_constants</span><span class="p">[</span><span class="s2">&quot;proton mass&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;cgs&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mp</span> <span class="o">*=</span> <span class="mf">1e3</span>
                    <span class="n">sp</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">atomic_weight</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;mks&quot;</span><span class="p">:</span>
                    <span class="n">sp</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">atomic_weight</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s2">&quot;mass_density&quot;</span><span class="p">):</span>
                <span class="n">Av</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">physical_constants</span><span class="p">[</span><span class="s2">&quot;Avogadro constant&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">sp</span><span class="o">.</span><span class="n">number_density</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">mass_density</span> <span class="o">*</span> <span class="n">Av</span> <span class="o">/</span> <span class="n">sp</span><span class="o">.</span><span class="n">atomic_weight</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">total_num_density</span> <span class="o">+=</span> <span class="n">sp</span><span class="o">.</span><span class="n">number_density</span>
        <span class="c1"># Concentrations arrays and ions&#39; total temperature</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_ion_temperature</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">):</span>
            <span class="n">sp</span><span class="o">.</span><span class="n">concentration</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">num</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_num_ptcls</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_ion_temperature</span> <span class="o">+=</span> <span class="n">sp</span><span class="o">.</span><span class="n">concentration</span> <span class="o">*</span> <span class="n">sp</span><span class="o">.</span><span class="n">temperature</span>

        <span class="c1"># Wigner-Seitz radius calculated from the total density</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aws</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_num_density</span><span class="p">))</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">potential</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;LJ&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ic</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_species</span><span class="p">):</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qe</span>

                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="s2">&quot;Z&quot;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">charge</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">Z</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Magnetic</span><span class="o">.</span><span class="n">on</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;cgs&quot;</span><span class="p">:</span>
                        <span class="c1">#  See https://en.wikipedia.org/wiki/Lorentz_force</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">omega_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">charge</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Magnetic</span><span class="o">.</span><span class="n">BField</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span>
                            <span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">mass</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">omega_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">omega_c</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">c0</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;mks&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">omega_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">charge</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Magnetic</span><span class="o">.</span><span class="n">BField</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span>
                            <span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">mass</span>

                <span class="c1"># Q^2 factor see eq.(2.10) in Ballenegger et al. J Chem Phys 128 034109 (2008)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">QFactor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">num</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">charge</span> <span class="o">**</span> <span class="mi">2</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">QFactor</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">QFactor</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tot_net_charge</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">charge</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">num</span>

        <span class="c1"># Calculate electron number density from the charge neutrality condition in case of Yukawa or EGS potential</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">potential</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;Yukawa&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">potential</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;EGS&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ic</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_species</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="s2">&quot;Z&quot;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ne</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">Z</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span><span class="o">.</span><span class="n">number_density</span>

        <span class="c1"># Simulation Box Parameters</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">np_per_side</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Number of particles per dimension does not match total number of particles.&quot;</span>
            <span class="k">assert</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">np_per_side</span><span class="p">))</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_num_ptcls</span><span class="p">,</span> <span class="n">msg</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">Lx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aws</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">np_per_side</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Ly</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aws</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">np_per_side</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Lz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aws</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">np_per_side</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Lx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aws</span> <span class="o">*</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_num_ptcls</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Ly</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aws</span> <span class="o">*</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_num_ptcls</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Lz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aws</span> <span class="o">*</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_num_ptcls</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Lv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">Lx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ly</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lz</span><span class="p">])</span>  <span class="c1"># box length vector</span>

        <span class="c1"># Dev Note: The following are useful for future geometries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">Lx</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ly</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lz</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">box_volume</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">e2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">e3</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Lv</span><span class="p">)</span>  <span class="c1"># no. of dimensions</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">T_desired</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_ion_temperature</span>

        <span class="c1"># boundary Conditions</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">pbc_axes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">pbc_axes_indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">pbc_axes</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ij</span><span class="p">,</span> <span class="n">bc</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">pbc_axes</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">bc</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">pbc_axes_indx</span><span class="p">[</span><span class="n">ij</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">elif</span> <span class="n">bc</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">pbc_axes_indx</span><span class="p">[</span><span class="n">ij</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">bc</span> <span class="o">==</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">pbc_axes_indx</span><span class="p">[</span><span class="n">ij</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">mm_axes</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Only Periodic Boundary Conditions are supported. Bye!&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">mm_axes_indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">mm_axes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ij</span><span class="p">,</span> <span class="n">bc</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">mm_axes</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">bc</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">mm_axes_indx</span><span class="p">[</span><span class="n">ij</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">elif</span> <span class="n">bc</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">mm_axes_indx</span><span class="p">[</span><span class="n">ij</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">bc</span> <span class="o">==</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">mm_axes_indx</span><span class="p">[</span><span class="n">ij</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">open_axes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">open_axes_indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">open_axes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">ij</span><span class="p">,</span> <span class="n">bc</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">open_axes</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">bc</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">open_axes_indx</span><span class="p">[</span><span class="n">ij</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">elif</span> <span class="n">bc</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">open_axes_indx</span><span class="p">[</span><span class="n">ij</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">bc</span> <span class="o">==</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">BC</span><span class="o">.</span><span class="n">open_axes_indx</span><span class="p">[</span><span class="n">ij</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, MurilloGroup
      <span class="lastupdated">
        Last updated on Aug, 18, 2020.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #18453b;
    }
    /* Sidebar */
    .wy-nav-side {
      background: #535054;
    }
    .wy-menu-vertical p.caption {
	  color: #fff;
	}
	.wy-menu-vertical a {
	  color: #eee;
	}
	.wy-menu-vertical a:hover {
    background-color: #18453b;
  }
/*  .wy-nav-content {
    max-width: 900px !important;
  }*/
}
  </style>


</body>
</html>