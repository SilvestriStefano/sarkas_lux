  

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Integrators &mdash; Sarkas 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Potentials" href="potentials.html" />
    <link rel="prev" title="Magnetized Plasma" href="../examples/Magnetized_Plasma.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo_orange_gray_v3.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../why_sarkas/why_sarkas.html">Why Sarkas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/Quickstart.html">Quickstart</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/input_file.html">Input File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/Pre_Simulation_Testing.html">Pre Simulation Testing</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/H-He_Mixture.html">H-He Mixture Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/QSP_Tutorial.html">Quantum Statistical Potential Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/Magnetized_Plasma.html">Magnetized Plasma</a></li>
</ul>
<p class="caption"><span class="caption-text">Theoretical Background:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Integrators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#phase-space-distribution">Phase Space Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#velocity-verlet">Velocity Verlet</a></li>
<li class="toctree-l2"><a class="reference internal" href="#magnetic-velocity-verlet">Magnetic Velocity Verlet</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="potentials.html">Potentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="thermostats.html">Thermostats</a></li>
<li class="toctree-l1"><a class="reference internal" href="PPPM.html">Particle-Particle Particle-Mesh Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="force_error.html">Force Error</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>
<p class="caption"><span class="caption-text">Code Development:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/code_dev.html">Guidelines</a></li>
</ul>
<p class="caption"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">sarkas</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Sarkas</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Integrators</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/theory/integrators.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="integrators">
<span id="id1"></span><h1>Integrators<a class="headerlink" href="#integrators" title="Permalink to this headline">¶</a></h1>
<p>Sarkas aims to support a variety of time integrators both built-in and user defined.
Currently the available ones are:</p>
<ul class="simple">
<li><p>Velocity Verlet</p></li>
<li><p>Velocity Verlet with Langeving Thermostat</p></li>
<li><p>Magnetic Velocity Verlet</p></li>
<li><p>Magnetic Boris</p></li>
</ul>
<p>The choice of integrator is provided in the input file and the method <code class="docutils literal notranslate"><span class="pre">sarkas.time_evolution.integrators.Integrator.setup</span></code>
links the chosen integrator to the <code class="docutils literal notranslate"><span class="pre">sarkas.time_evolution.integrators.Integrator.update</span></code> method which evolves
particles’ positions, velocities, and accelerations in time.</p>
<p>The Velocity Verlet algorithm is the most common integrator used in MD plasma codes.
It is preferred to other more accurate integrator, such as RK45, inasmuch as it conserves the symmetries of the
Hamiltonian, it is fast, and easy to implement.</p>
<div class="section" id="phase-space-distribution">
<h2>Phase Space Distribution<a class="headerlink" href="#phase-space-distribution" title="Permalink to this headline">¶</a></h2>
<p>The state of the system is defined by the set of phase space coordinates
<span class="math notranslate nohighlight">\(\{ \mathbf r, \mathbf p \} = \{ \mathbf r_1, \mathbf r_2, \dots, \mathbf r_N , \mathbf p_1, \mathbf p_2, \dots, \mathbf p_N \}\)</span>
where <span class="math notranslate nohighlight">\(N\)</span> represents the number of particles. The system evolves in time according to the Hamiltonian</p>
<div class="math notranslate nohighlight">
\[\mathcal H = \mathcal T + \mathcal U,\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal T\)</span> is the kinetic energy and <span class="math notranslate nohighlight">\(\mathcal U\)</span> the interaction potential. The <span class="math notranslate nohighlight">\(N\)</span>-particle
probability distribution <span class="math notranslate nohighlight">\(f_N(\mathbf r, \mathbf p; t)\)</span> evolves in time according to the Liouville equation</p>
<div class="math notranslate nohighlight">
\[i\mathcal L f_N(\mathbf r, \mathbf p;0) = 0,\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\mathcal L = \frac{\partial}{\partial t} + \dot{\mathbf r} \cdot \frac{\partial}{\partial \mathbf r} + \dot{\mathbf p}\cdot \frac{\partial}{\partial \mathbf p},\]</div>
<div class="math notranslate nohighlight">
\[\dot{\mathbf r} = \frac{\partial \mathcal H}{\partial \mathbf p}, \quad \dot{\mathbf p} = - \frac{\partial \mathcal H}{\partial \mathbf r}.\]</div>
<p>The solution of the Liouville equation is</p>
<div class="math notranslate nohighlight">
\[\mathcal f_N(\mathbf r, \mathbf p;t) =  e^{- i \mathcal L t } f_N(\mathbf r, \mathbf p;0)\]</div>
</div>
<div class="section" id="velocity-verlet">
<h2>Velocity Verlet<a class="headerlink" href="#velocity-verlet" title="Permalink to this headline">¶</a></h2>
<p>It can be shown that the Velocity Verlet corresponds to a second order splitting of the Liouville operator <span class="math notranslate nohighlight">\(\mathcal L =  K +  V\)</span></p>
<div class="math notranslate nohighlight">
\[e^{i \epsilon \mathcal L} \approx e^{\frac{\Delta t}{2} K}e^{\Delta t V}e^{\frac{\Delta t}{2} K}\]</div>
<p>where <span class="math notranslate nohighlight">\(\epsilon = -i \Delta t\)</span> and the operators</p>
<div class="math notranslate nohighlight">
\[K = \mathbf v \cdot \pdv{\mathbf r}, \quad
V = \mathbf a \cdot \pdv{\mathbf v}.\]</div>
<p>Any dynamical quantities <span class="math notranslate nohighlight">\(W\)</span> evolves in time according to the Liouville operator <span class="math notranslate nohighlight">\(\mathcal L =  K +  V\)</span></p>
<div class="math notranslate nohighlight">
\[W(t) = e^{i\epsilon (K +  V)} W(0).\]</div>
<p>Applying each one of these to the initial set <span class="math notranslate nohighlight">\(\mathbf W = ( \mathbf r_0, \mathbf v_0)\)</span> we find
<span class="math notranslate nohighlight">\(e^{i\epsilon V} \mathbf r_0 = e^{i\epsilon K} \mathbf v_0 = 0\)</span> and</p>
<div class="math notranslate nohighlight">
\[\begin{split}e^{i \epsilon K} \mathbf r_0 &amp; = &amp;  \left ( 1 + \Delta t K - \frac{\Delta t^2 K^2}{2!} + \frac{\Delta t^3 K^3}{3!} + ... \right ) \mathbf r_0 \nonumber \\  &amp; = &amp; \left [ 1 + \Delta t \mathbf v \cdot \frac{\partial}{\partial \mathbf r} - \frac{\Delta t^2}{2} \left ( \mathbf v \cdot \frac{\partial}{\partial \mathbf r} \right )^2 + ... \right ] \mathbf r_0 \nonumber \\
    &amp; = &amp; \mathbf r_0 + \Delta t \mathbf v\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}e^{i \epsilon V} \mathbf v_0 &amp; = &amp;  \left ( 1 + \Delta t V - \frac{\Delta t^2 V^2}{2!} + \frac{\Delta t^3 V^3}{3!} + ... \right ) \mathbf r_0 \nonumber \\  &amp; = &amp; \left [ 1 + \Delta t \mathbf a \cdot \frac{\partial}{\partial \mathbf v} - \frac{\Delta t^2}{2} \left ( \mathbf a \cdot \frac{\partial}{\partial \mathbf v} \right )^2 + ... \right ] \mathbf v_0 \nonumber \\
    &amp; = &amp; \mathbf v_0 + \Delta t \mathbf a\end{split}\]</div>
</div>
<div class="section" id="magnetic-velocity-verlet">
<h2>Magnetic Velocity Verlet<a class="headerlink" href="#magnetic-velocity-verlet" title="Permalink to this headline">¶</a></h2>
<p>A generalization to include constant external magnetic fields leads to the Liouville operator
<span class="math notranslate nohighlight">\(e^{i \epsilon( K + V + L_B)}\)</span> where <a class="bibtex reference internal" href="references.html#chin2008" id="id2">[Chi08]</a></p>
<div class="math notranslate nohighlight">
\[L_B = \omega_c \left ( \hat{\mathbf B} \times \mathbf v \right ) \cdot \frac{\partial}{\partial \mathbf v}  = \omega_c \hat{\mathbf B} \cdot \left( \mathbf v \times \frac{\partial}{\partial \mathbf v} \right ) = \omega_c \hat{\mathbf B} \cdot \mathbf J_{\mathbf v}.\]</div>
<p>Application of this operator leads to <span class="math notranslate nohighlight">\(e^{i \epsilon L_B}\vb{r}_0 = 0\)</span> and</p>
<div class="math notranslate nohighlight">
\[\begin{split}e^{ i \epsilon L_B } \mathbf v_0 &amp; = &amp;  \left ( 1 + \Delta t V - \frac{\Delta t^2 V^2}{2!} + \frac{\Delta t^3 V^3}{3!} + ... \right ) \mathbf v_0 \nonumber \\  &amp; = &amp; \left [ 1 + \omega_c \Delta t  \hat{\mathbf B} \cdot \mathbf J_{\mathbf v} - \frac{\omega_c^2 \Delta t^2}{2}  \left ( \hat{\mathbf B} \cdot \mathbf J_{\mathbf v} \right )^2 + ... \right ] \mathbf v_0 \nonumber \\
&amp; = &amp; \begin{pmatrix}
\cos(\omega_c\Delta t) &amp; - \sin(\omega_c\Delta t) &amp; 0 \\
\sin(\omega_c\Delta t) &amp; \cos(\omega_c\Delta t) &amp; 0 \\
0 &amp; 0 &amp; 1 \\
\end{pmatrix} \mathbf v_0 \\
&amp; = &amp;\mathbf v_{0,\parallel} + \cos(\omega_c \Delta t) \mathbf v_{0,\perp} + \sin(\omega_c \Delta t) \hat{\mathbf B} \times \mathbf v_{0, \perp},\end{split}\]</div>
<p>where in the last passage we have divided the velocity in its parallel and perpendicular component to the
<span class="math notranslate nohighlight">\(\\mathbf B\)</span> field. In addition, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}e^{i \epsilon (L_B + V) } \mathbf v_0 &amp; = &amp; e^{i \epsilon L_B} \mathbf v_0 + \Delta t \mathbf a + \frac{1 - \cos(\omega_c \Delta t)}{\omega_c} \left ( \hat{\mathbf B} \cross \mathbf a \right ) \nonumber \\
&amp;&amp; + \Delta t \left ( 1 - \frac{\sin(\omega_c \Delta t)}{\omega_c \Delta t} \right ) \left [ \hat {\mathbf B} \cross \left ( \hat{\mathbf B} \cross \mathbf a \right ) \right ].\end{split}\]</div>
<p>Time integrators of various order can be found by exponential splitting, that is</p>
<div class="math notranslate nohighlight">
\[e^{i \epsilon \mathcal L} \approx \prod_{ j = 1}^{N} e^{i a_j \epsilon K} e^{i b_j \epsilon \left ( L_B + V \right ) }.\]</div>
<p>The Boris algorithm, widely used in Particle in Cell simulations, corresponds to <a class="bibtex reference internal" href="references.html#chin2008" id="id3">[Chi08]</a></p>
<div class="math notranslate nohighlight">
\[e^{i \epsilon \mathcal L} \approx e^{i \epsilon K} e^{i \epsilon V/2}  e^{i \epsilon L_B} e^{i \epsilon V/2}\]</div>
<p>while a generalization of the Velocity-Verlet <a class="bibtex reference internal" href="references.html#chin2008" id="id4">[Chi08]</a><a class="bibtex reference internal" href="references.html#spreiter1999" id="id5">[SW99]</a></p>
<div class="math notranslate nohighlight">
\[e^{i \epsilon \mathcal L} \approx  e^{i \epsilon (L_B + V) /2} e^{i \epsilon K} e^{i \epsilon ( L_B + V)/2}.\]</div>
<p>Notice that all the above algorithm require one force calculation per time step.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="potentials.html" class="btn btn-neutral float-right" title="Potentials" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../examples/Magnetized_Plasma.html" class="btn btn-neutral float-left" title="Magnetized Plasma" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, MurilloGroup
      <span class="lastupdated">
        Last updated on Feb, 08, 2021.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #18453b;
    }
    /* Sidebar */
    .wy-nav-side {
      background: #535054;
    }
    .wy-menu-vertical p.caption {
	  color: #fff;
	}
	.wy-menu-vertical a {
	  color: #eee;
	}
	.wy-menu-vertical a:hover {
    background-color: #18453b;
  }
/*  .wy-nav-content {
    max-width: 900px !important;
  }*/
}
  </style>


</body>
</html>